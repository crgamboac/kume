<!DOCTYPE html>
<html
	lang="es"
	xmlns:th="http://www.thymeleaf.org"
	th:replace="~{shared/layout :: layout(~{::title}, ~{::content})}"
>
	<head>
		<meta charset="UTF-8" />
		<title>Registrar Nueva Receta</title>
	</head>

	<body>
		<div th:fragment="content">
			<div class="container mt-4" id="content">
				<section class="p-5 bg-light shadow rounded">
					<h1 class="mb-4">Registrar Nueva Receta</h1>

					<form
						th:action="@{/recipes/create}"
						th:object="${recipeRequest}"
						method="post"
						enctype="multipart/form-data"
						class="row g-3"
					>
						<!-- Nombre -->
						<div class="col-md-6">
							<label class="form-label">Nombre</label>
							<input type="text" class="form-control" th:field="*{name}" />
						</div>

						<!-- Tiempo -->
						<div class="col-md-6">
							<label class="form-label">Tiempo de Uso (minutos)</label>
							<input
								type="number"
								class="form-control"
								th:field="*{cookingTime}"
							/>
						</div>

						<!-- Dificultad -->
						<div class="col-md-6">
							<label class="form-label">Dificultad</label>
							<select class="form-select" th:field="*{difficulty}">
								<option value="">Seleccione...</option>
								<option
									th:each="level : ${difficultyLevels}"
									th:value="${level}"
									th:text="${level}"
								></option>
							</select>
						</div>

						<!-- Tipo -->
						<div class="col-md-6">
							<label class="form-label">Tipo de Cocina</label>
							<input type="text" class="form-control" th:field="*{type}" />
						</div>

						<!-- País -->
						<div class="col-md-6">
							<label class="form-label">País de Origen</label>
							<input type="text" class="form-control" th:field="*{country}" />
						</div>

						<!-- Imagen -->
						<div class="col-md-6">
							<label class="form-label">Imagen Principal</label>
							<input type="file" class="form-control" th:field="*{imageFile}" />
						</div>

						<!-- Ingredientes -->
						<div class="col-12 mt-4">
							<h4>Ingredientes</h4>

							<label class="form-label">Seleccionar Ingredientes</label>
							<select
								multiple
								class="form-select"
								name="ingredientsSelect"
								id="ingredientsSelect"
							>
								<option
									th:each="ing : ${allIngredients}"
									th:value="${ing.id}"
									th:text="${ing.name}"
								></option>
							</select>

							<!-- Cantidades dinámicas -->
							<div
								id="ingredients-container"
								class="mt-3 d-flex flex-column gap-3"
							></div>

							<button
								type="button"
								class="btn btn-outline-primary mt-2"
								id="addIngredientBtn"
							>
								Añadir Cantidad a Ingrediente Seleccionado
							</button>
						</div>

						<!-- Pasos -->
						<div class="col-12 mt-4">
							<h4>Pasos</h4>

							<div id="steps-container" class="d-flex flex-column gap-3">
								<div class="border rounded p-3 bg-white">
									<label class="form-label">Número de Paso</label>
									<input
										type="number"
										name="steps[0].stepNumber"
										class="form-control"
									/>

									<label class="form-label mt-2">Instrucción</label>
									<textarea
										name="steps[0].instruction"
										class="form-control"
									></textarea>
								</div>
							</div>

							<button
								type="button"
								class="btn btn-outline-primary mt-3"
								id="addStepBtn"
							>
								Añadir Paso
							</button>
						</div>

						<div class="col-12 mt-4">
							<h4>Multimedia</h4>
							<div id="media-container" class="d-flex flex-column gap-3">
								<div class="media-item border rounded p-3 bg-white">
									<div class="row g-3 align-items-center">
										<div class="col-md-6">
											<label class="form-label">Archivo</label>
											<input
												type="file"
												name="extraImages"
												class="form-control"
											/>
										</div>
										<div class="col-md-6">
											<label class="form-label">Tipo</label>
											<select name="mediaTypes" class="form-select">
												<option value="IMAGE">Imagen</option>
												<option value="VIDEO">Video</option>
											</select>
										</div>
									</div>
								</div>
							</div>

							<button
								type="button"
								class="btn btn-outline-primary mt-3"
								id="addMediaBtn"
							>
								Añadir otro archivo
							</button>
						</div>

						<div class="col-12 mt-4">
							<button type="submit" class="btn btn-success w-100">
								Guardar Receta
							</button>
						</div>
					</form>

					<a th:href="@{/recipes/list}" class="btn btn-link mt-3"
						>Volver al listado</a
					>
				</section>
			</div>
		</div>
	</body>
</html>
